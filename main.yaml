imports:
- path: vm.jinja

resources:
- name: deploy-btcpay-vm-with-btcpay-server
  type: vm.jinja
  properties:
    region: asia-northeast1
    zone: asia-northeast1-b
    startup-script: |
      #!/bin/bash
      apt-get update
      apt-get -y install git
      mkdir /var/BTCPayServer
      cd /var/BTCPayServer/
      git clone https://github.com/btcpayserver/btcpayserver-docker
      cd btcpayserver-docker/
      export BTCPAY_HOST="btcpayreg1.indiesquare.net"
      export NBITCOIN_NETWORK="regtest"
      export BTCPAYGEN_CRYPTO1="btc"
      export BTCPAYGEN_REVERSEPROXY="nginx"
      export BTCPAYGEN_LIGHTNING="lnd"
      . ./btcpay-setup.sh -i
